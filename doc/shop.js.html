<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: shop.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: shop.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Handles the back-end logic for ShopScene.
 */

let player_points = parseInt(document.getElementById('points').getAttribute('data-points'));

/**
 * Determines if the item can buy an item.
 * If so, adds the item to the player's inventory,
 * then calls updateUIAfterPurchase.
 *
 * @param item
 * @param updateUI
 * @param button
 * @param points
 *
 * @see updateUIAfterPurchase
 */
function purchaseItem(item, updateUI, button, points) {
    let itemName = item.name;
    let itemCost = item.cost;
    // could get rid of this check since it's handled by the button
    if (playerInventoryData.some(function(playerItem) {
        return playerItem.name === item.name;
    })) {
        alert('You already own this item.');
    } else {
        if (player_points >= itemCost) {
            player_points -= itemCost;
            // buy_item() goes here
            buy_item(itemName, itemCost).then(alert(`You've purchased ${itemName} for ${itemCost} points.`));
            playerInventoryData.push(item);
            updateUI(item, button, points); // calling updateUIAfterPurchase in ShopScene
        } else {
            alert("You don't have enough points to purchase this item.")
        }
    }
}

/**
 * Sends a JSON POST request back to app.py with the name of the item being purchased and its cost.
 * @param item_name the item being bought
 * @param item_cost the cost of the item being bought
 * @returns {Promise&lt;void>} void ("returns" once response is received back)
 */
async function buy_item(item_name, item_cost) {
    let target_url = document.URL.slice(0, document.URL.lastIndexOf("/") + 1).concat("buy_item");
    let data = {"itemName": item_name, "itemCost": item_cost};
    let request = new Request(target_url, {method: "POST", body: JSON.stringify(data)});
    fetch(request);
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#buy_item">buy_item</a></li><li><a href="global.html#player_points">player_points</a></li><li><a href="global.html#purchaseItem">purchaseItem</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Wed Nov 15 2023 22:12:07 GMT-0500 (Eastern Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
